# Chapter 48 : Gesture

- tap, double tap, long press, drag, zoom, rotation, ...

## Click Gesture

~~~
@Composable
fun ClickGesture() {

    var colorState by remember { mutableStateOf(true) }
    var bgColor by remember { mutableStateOf(Color.Blue) }

    val clickHandler = {

        colorState = !colorState

        bgColor = if (colorState) {
            Color.Blue
        } else {
            Color.DarkGray
        }
    }

    Box(modifier = Modifier
        .clickable { clickHandler() }
        .background(bgColor)
        .size(100.dp))

}
~~~

## PointerInputScope

- clickable Modifier 는 탭, 프레스, 롱프레스, 더블탭 등을 구분하지 못함

~~~
@Composable
fun TabPressGesture() {

    var textState by remember { mutableStateOf("No Gesture") }

    val tapHandler = { status: String ->
        textState = status
    }

    Column(
        horizontalAlignment = Alignment.CenterHorizontally,
        modifier = Modifier.fillMaxSize()
    ) {
        Box(
            modifier = Modifier
                .background(Color.Blue)
                .size(100.dp)
                .pointerInput(Unit) {
                    detectTapGestures(
                        onPress = { tapHandler("onPress") },
                        onDoubleTap = { tapHandler("onDoubleTap") },
                        onLongPress = { tapHandler("onLongPress") },
                        onTap = { tapHandler("onTap") }
                    )
                }
        )
        Spacer(Modifier.height(10.dp))
        Text(text = textState)
    }
}
~~~

## Drag Gesture

~~~
@Composable
fun DragGesture() {

    Box(Modifier.fillMaxSize()) {

        var x by remember { mutableStateOf(0f) }

        Box(Modifier
            .offset { IntOffset(x.roundToInt(), 0) }
            .size(100.dp)
            .background(Color.Blue)
            .draggable(
                orientation = Orientation.Horizontal,
                state = rememberDraggableState {
                    x += it
                }
            ))
    }
}
~~~

## PointerInputScope Drag

- PointerInputScope는 수직 수평 동시 조작 지원

~~~
Modifier
  .pointInput(Unit) { _, distance
      x += distance.x
      y += distance.y
  }
~~~

## Scrollable

~~~
@Composable
fun ScrollableModifier() {

    var offset by remember { mutableStateOf(0f) }

    Box(
        Modifier
            .fillMaxSize()
            .scrollable(
                orientation = Orientation.Vertical,
                state = rememberScrollableState {
                    offset += it
                    it
                }
            ))
    {
        Box(Modifier
            .size(90.dp)
            .offset { IntOffset(0, offset.roundToInt()) }
            .background(Color.Red))
    }
}
~~~

## Scrollables

~~~
@Composable
fun ScrollableModifiers() {

    val image = ImageBitmap.imageResource(id = R.drawable.img)

    Box(
        Modifier
            .size(150.dp)
            .verticalScroll(rememberScrollState())
            .horizontalScroll(rememberScrollState())
    ) {
        Canvas(Modifier.size(300.dp, 300.dp)) {
            drawImage(
                image = image,
                topLeft = Offset(0f, 0f)
            )
        }
    }
}
~~~

## Pinch / Rotation / Transform Gesture

~~~
@Composable
fun MultiTouch() {

    var scale by remember { mutableStateOf(1f) }
    var angle by remember { mutableStateOf(0f) }
    var offset by remember { mutableStateOf(Offset.Zero) }

    val state = rememberTransformableState { scaleChange, offsetChange, rotationChange ->
        scale += scaleChange
        angle += rotationChange
        offset += offsetChange
    }

    Box(
        modifier = Modifier.fillMaxSize(),
        contentAlignment = Alignment.Center
    ) {
        Box(
            Modifier
                .graphicsLayer(
                    scaleX = scale,
                    scaleY = scale,
                    rotationZ = angle,
                    translationX = offset.x,
                    translationY = offset.y
                )
                .transformable(state)
                .background(Color.Blue)
                .size(100.dp)
        )
    }
}
~~~

# Chapter 49 : Swipe Gesture

- Anchor : 스와이프 축을 따라 화면에 존재하는 고정된 위치
- Threshold : 두 앵커 사이의 한 지점(임계점)으로, 임계점에 도달 전 스와이프 모션이 끝나면 첫 앵커로, 임계점을 넘으면 다음 앵커로 움직인다.
- Modifier의 swipeable() 모디파이어를 호출해 사용

## Parameters

- state: SwipeableState
- anchor: Map -앵커 지점들과 상태들을 연결
- orientation: Orientation
- enabled: Boolean
- reverseDirection: Boolean
- thresholds: (from, to) - 앵커 사이 임계점들의 위치 지정
- resistance: ResistanceConfig?
- velocityThreshold: Dp

## Anchor

~~~
val swipeableState = rememberSwipeableState("On")
val anchors = mapOf(0f to "On", 150f to "Off", 300f to "Locked")

... swipeableState.currentValue
~~~

## Threshold

~~~
{ _, _ -> FractionalThreshold(0.5f) } // 비율
{ _, _ -> FractionalThreshold(20.dp) } // 고정 포인트
~~~

## Component Swipe

~~~
Text(swipeableState.currentValue,
    modifier = Modifier.offset { IntOffset(swipeableState.offset.value.roundToInt(), 0) }
    )
~~~

## Tutorial

~~~
@OptIn(ExperimentalMaterialApi::class)
@Composable
fun SwipeTutorial() {

    val parentBoxWidth = 320.dp
    val childBoxSides = 30.dp

    val swipeableState = rememberSwipeableState(initialValue = "L")
    val widthPx = with(LocalDensity.current) {
        (parentBoxWidth - childBoxSides).toPx()
    }

    val anchors = mapOf(
        0f to "L", widthPx / 2 to "C", widthPx to "R"
    )

    Box(
        Modifier
            .padding(20.dp)
            .width(parentBoxWidth)
            .height(childBoxSides)
            .swipeable(
                state = swipeableState,
                anchors = anchors,
                thresholds = { _, _ -> FractionalThreshold(0.5f) },
                orientation = Orientation.Horizontal
            )
    ) {
        Box(modifier = Modifier
            .offset { IntOffset(swipeableState.offset.value.roundToInt(), 0) }
            .size(childBoxSides)
            .background(Color.Blue),
            contentAlignment = Alignment.Center
        ) {
            Text(
                text = swipeableState.currentValue,
                color = Color.White,
                fontSize = 22.sp
            )
        }
    }
}
~~~

# Chapter 50 : Flow
